import{u as S,r as c,j as e,b as F,L as k}from"./index-DOJNHyVV.js";import{a as C,c as D}from"./api-Csd6WsQO.js";function E({courseId:l,onAssignmentCreated:m,onClose:s}){const{currentUser:b}=S(),[t,x]=c.useState({title:"",description:"",dueDate:"",points:"",instructions:""}),[u,f]=c.useState(!1),[y,d]=c.useState(""),n=j=>{const{name:o,value:i}=j.target;x(r=>({...r,[o]:i}))},p=async j=>{var o,i;if(j.preventDefault(),!b){d("You must be logged in to create assignments");return}f(!0),d("");try{const r={...t,courseId:l,points:parseInt(t.points,10),dueDate:new Date(t.dueDate).toISOString()},N=(await C.createAssignment(r)).data.data;m&&m(N),x({title:"",description:"",dueDate:"",points:"",instructions:""}),s&&s()}catch(r){console.error("Error creating assignment:",r),d(((i=(o=r.response)==null?void 0:o.data)==null?void 0:i.message)||"Failed to create assignment. Please try again.")}finally{f(!1)}};return b?e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Create New Assignment"}),s&&e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),y&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:y}),e.jsxs("form",{onSubmit:p,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700",children:"Assignment Title *"}),e.jsx("input",{type:"text",id:"title",name:"title",value:t.title,onChange:n,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter assignment title"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700",children:"Description *"}),e.jsx("textarea",{id:"description",name:"description",rows:4,value:t.description,onChange:n,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"Describe the assignment requirements"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dueDate",className:"block text-sm font-medium text-gray-700",children:"Due Date *"}),e.jsx("input",{type:"datetime-local",id:"dueDate",name:"dueDate",value:t.dueDate,onChange:n,required:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"points",className:"block text-sm font-medium text-gray-700",children:"Points/Marks *"}),e.jsx("input",{type:"number",id:"points",name:"points",value:t.points,onChange:n,required:!0,min:"1",max:"1000",className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., 100"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"instructions",className:"block text-sm font-medium text-gray-700",children:"Detailed Instructions"}),e.jsx("textarea",{id:"instructions",name:"instructions",rows:6,value:t.instructions,onChange:n,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"Provide detailed instructions, requirements, and any additional information"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s&&e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:u,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:u?"Creating...":"Create Assignment"})]})]})]}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-600",children:"You must be logged in to create assignments."})})}function L({assignment:l,onSubmissionComplete:m,onClose:s}){const{currentUser:b}=S(),[t,x]=c.useState({submissionText:"",attachment:null}),[u,f]=c.useState(!1),[y,d]=c.useState(""),n=o=>{const{name:i,value:r}=o.target;x(h=>({...h,[i]:r}))},p=o=>{const i=o.target.files[0];if(i){if(i.size>10*1024*1024){d("File size must be less than 10MB");return}x(r=>({...r,attachment:i})),d("")}},j=async o=>{var i,r;if(o.preventDefault(),!b){d("You must be logged in to submit assignments");return}if(!t.submissionText.trim()&&!t.attachment){d("Please provide either a text submission or attach a file");return}f(!0),d("");try{const h={assignmentId:l._id||l.id,submissionText:t.submissionText.trim(),submittedAt:new Date().toISOString()},g=(await C.submitAssignment(l._id||l.id,h)).data.data;m&&m(g),x({submissionText:"",attachment:null}),s&&s()}catch(h){console.error("Error submitting assignment:",h),d(((r=(i=h.response)==null?void 0:i.data)==null?void 0:r.message)||"Failed to submit assignment. Please try again.")}finally{f(!1)}};return b?e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Submit Assignment"}),s&&e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),y&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:y}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"submissionText",className:"block text-sm font-medium text-gray-700",children:"Submission Text"}),e.jsx("textarea",{id:"submissionText",name:"submissionText",rows:6,value:t.submissionText,onChange:n,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"Paste your work or write a summary here"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"attachment",className:"block text-sm font-medium text-gray-700",children:"Attachment (optional)"}),e.jsx("input",{type:"file",id:"attachment",name:"attachment",onChange:p,className:"mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100"}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Upload PDF, DOCX, or ZIP files up to 10MB."})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[s&&e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:u,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50",children:u?"Submitting...":"Submit Assignment"})]})]})]}):e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-600",children:"You must be logged in to submit assignments."})})}function P(){const{courseId:l}=F(),{currentUser:m}=S(),[s,b]=c.useState(null),[t,x]=c.useState([]),[u,f]=c.useState([]),[y,d]=c.useState(!0),[n,p]=c.useState("overview"),[j,o]=c.useState(!1),[i,r]=c.useState(null);c.useEffect(()=>{l&&(async()=>{try{d(!0);const v=await D.getCourseById(l);b(v.data.data);const A=await C.getAssignments(l);if(x(A.data.data||[]),(m==null?void 0:m.role)==="teacher")try{const w=await D.getEnrolledStudents(l);f(w.data.data||[])}catch(w){console.log("Error fetching enrolled students:",w)}d(!1)}catch(v){console.error("Error fetching course data:",v),d(!1)}})()},[l,m]);const h=a=>{x(v=>[...v,a]),o(!1)},N=a=>{console.log("Assignment submitted:",a),r(null)},g=(m==null?void 0:m.role)==="teacher";return y?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500"})}):s?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:s.title}),e.jsx("p",{className:"mt-2 text-gray-600",children:s.description}),s.duration&&e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Duration: ",s.duration]})]}),e.jsx(k,{to:"/courses",className:"text-primary-600 hover:text-primary-700",children:"← Back to Courses"})]}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8",children:[e.jsx("button",{onClick:()=>p("overview"),className:`py-2 px-1 border-b-2 font-medium text-sm ${n==="overview"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Overview"}),e.jsxs("button",{onClick:()=>p("assignments"),className:`py-2 px-1 border-b-2 font-medium text-sm ${n==="assignments"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Assignments (",t.length,")"]}),g&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>p("students"),className:`py-2 px-1 border-b-2 font-medium text-sm ${n==="students"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Students (",u.length,")"]}),e.jsx("button",{onClick:()=>p("submissions"),className:`py-2 px-1 border-b-2 font-medium text-sm ${n==="submissions"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"View Submissions"})]})]})}),j&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white",children:e.jsx(E,{courseId:l,onAssignmentCreated:h,onClose:()=>o(!1)})})}),i&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white",children:e.jsx(L,{assignment:i,onSubmissionComplete:N,onClose:()=>r(null)})})}),n==="overview"&&e.jsxs("div",{className:"bg-white shadow rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Course Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700",children:"Course Details"}),e.jsx("p",{className:"mt-2 text-gray-600",children:s.description}),s.duration&&e.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Duration: ",s.duration]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-700",children:"Enrollment"}),e.jsxs("p",{className:"mt-2 text-gray-600",children:[u.length," students enrolled"]}),e.jsxs("p",{className:"mt-2 text-gray-600",children:[t.length," assignments available"]})]})]})]}),n==="assignments"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Assignments"}),g&&e.jsx("button",{onClick:()=>o(!0),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Create Assignment"})]}),t.length>0?e.jsx("div",{className:"grid gap-4",children:t.map(a=>e.jsx("div",{className:"bg-white shadow rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:a.title}),e.jsx("p",{className:"mt-1 text-gray-600",children:a.description}),e.jsxs("div",{className:"mt-2 flex items-center space-x-4 text-sm text-gray-500",children:[e.jsxs("span",{children:["Due: ",new Date(a.dueDate).toLocaleDateString()]}),e.jsxs("span",{children:["Points: ",a.points]}),e.jsxs("span",{children:["Status: ",a.status||"Active"]})]})]}),e.jsxs("div",{className:"flex space-x-2 ml-4",children:[e.jsx("button",{onClick:()=>r(a),className:"px-3 py-1 text-sm border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"View Details"}),!g&&e.jsx("button",{onClick:()=>r(a),className:"px-3 py-1 text-sm bg-primary-600 text-white rounded-md hover:bg-primary-700",children:"Submit"})]})]})},a._id))}):e.jsxs("div",{className:"text-center py-12 bg-white rounded-lg shadow",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No assignments"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:g?"Create your first assignment for this course.":"No assignments have been posted yet."}),g&&e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>o(!0),className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"Create Assignment"})})]})]}),n==="students"&&g&&e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[e.jsxs("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",children:["Enrolled Students (",u.length,")"]}),u.length>0?e.jsx("div",{className:"space-y-3",children:u.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.name}),e.jsx("div",{className:"text-sm text-gray-500",children:a.email})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Enrolled: ",new Date(a.enrolledAt).toLocaleDateString()]})]},a._id))}):e.jsx("div",{className:"text-center py-8 text-gray-500",children:"No students have enrolled in this course yet."})]})}),n==="submissions"&&g&&e.jsx("div",{className:"text-center py-8",children:e.jsx(k,{to:`/courses/${l}/submissions`,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:"View All Submissions"})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Course not found"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"The course you're looking for doesn't exist."}),e.jsx(k,{to:"/courses",className:"mt-4 inline-flex items-center text-primary-600 hover:text-primary-700",children:"← Back to Courses"})]})}export{P as default};
